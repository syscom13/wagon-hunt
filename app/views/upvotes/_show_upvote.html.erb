<% if user_signed_in? %>

  <% if current_user.voted_for?(product)%>

    <%= link_to upvote_path(current_user.upvotes.where(product: product).first), remote: true, class: 'product-upvote product-upvoted', method: :delete do %>
      <div class="product-arrow"></div>
      <div class='product-count'><%= product.upvotes.size %></div>
    <% end %>

  <% else %>

    <%= link_to upvotes_path(product_id: product.id), remote: true, class: 'product-upvote', method: :post do %>
      <div class="product-arrow"></div>
      <div class='product-count'><%= product.upvotes.size %></div>
    <% end %>

  <% end %>

<% else %>

  <div class="product-upvote">
    <div class="product-arrow"></div>
    <div class='product-count'><%= product.upvotes.size %></div>
  </div>

<% end %>
